<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta name="description" content="Sobreviva 100 Dias: Jogo online de sobreviv√™ncia PWA, com invent√°rio, eventos aleat√≥rios e conquistas.">
<meta name="keywords" content="Jogo, PWA, Sobreviv√™ncia, HTML5, JavaScript, 100 dias">
<meta name="author" content="Seu Nome">
<meta name="robots" content="index, follow">
<meta name="google-site-verification" content="MNWcD7sdoqGlWrQnGLeKgTEVaEvUeI9oSSvDL80BW_4" />
<meta charset="UTF-8">
<title>Sobreviva 100 Dias</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#070707">
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:monospace}
body{background:#070707;color:#e0e0e0;height:100vh;transition:.4s}
body.perigo{background:#180000}
body.critico{background:#300000;animation:pulsar 1s infinite}
@keyframes pulsar{0%{background:#300000}50%{background:#480000}100%{background:#300000}}

.tela{display:none;height:100vh;padding:20px}
.tela.ativa{display:flex;flex-direction:column;justify-content:center;align-items:center}

h1,h2{margin-bottom:20px;text-align:center}

button{
  background:#111;color:#eee;border:1px solid #555;
  padding:12px 22px;margin:6px;cursor:pointer
}
button:hover{background:#333}

#jogo{justify-content:space-between}
.status{display:flex;gap:15px;flex-wrap:wrap;margin-bottom:10px}

#log{
  width:100%;max-width:520px;height:200px;
  border:1px solid #333;padding:10px;
  background:#0e0e0e;overflow-y:auto;font-size:.9em
}

.acoes{display:flex;gap:10px;flex-wrap:wrap;justify-content:center}

/* Conquistas e Invent√°rio */
#btnConq,#btnInv{position:fixed;top:10px;z-index:10}
#btnConq{right:10px}
#btnInv{right:70px}

#painelConq,#painelInv{
  position:fixed;top:0;width:280px;height:100vh;
  background:#0b0b0b;border-left:1px solid #333;
  padding:15px;display:none;overflow-y:auto;z-index:20
}
#painelConq{right:0}
#painelInv{right:0}

.conq,.item{padding:8px;border-bottom:1px solid #222;font-size:.85em;cursor:pointer}
.locked{color:#555}
.unlocked{color:#ddd}

/* Tooltip de item */
.item:hover::after{
  content: attr(data-desc);
  display:block;
  background:#222;
  color:#eee;
  padding:3px 6px;
  margin-top:2px;
  font-size:0.8em;
}

/* Botoes de save/restart */
#botoesSave{
  position:fixed;
  left:10px;
  top:35px;
  display:flex;
  flex-direction:column;
  gap:6px;
  z-index:20;
}
</style>
</head>
<body>

<!-- Bot√µes fixos -->
<button id="btnConq" onclick="toggleConq()">üèÜ</button>
<button id="btnInv" onclick="toggleInv()">üéí</button>

<div id="botoesSave">
  <button id="btnSave" onclick="salvarJogo()">üíæ Salvar Jogo</button>
  <button onclick="reiniciarJogo()">üîÑ Reiniciar</button>
</div>

<!-- Pain√©is -->
<div id="painelConq">
  <button onclick="toggleConq()">‚ùå Fechar</button>
  <h3>Conquistas</h3>
  <div id="listaConq"></div>
</div>

<div id="painelInv">
  <button onclick="toggleInv()">‚ùå Fechar</button>
  <h3>Invent√°rio</h3>
  <div id="listaInv"></div>
</div>

<!-- Menu -->
<div id="menu" class="tela ativa">
  <h1>Sobreviva 100 Dias</h1>
  <button onclick="mostrarTela('dificuldade')">PLAY</button>
</div>

<!-- Sele√ß√£o de dificuldade -->
<div id="dificuldade" class="tela">
  <h2>Dificuldade</h2>
  <button onclick="iniciarJogo('facil')">F√°cil</button>
  <button onclick="iniciarJogo('normal')">Normal</button>
  <button onclick="iniciarJogo('dificil')">Dif√≠cil</button>
</div>

<!-- Jogo -->
<div id="jogo" class="tela">
  <div class="status">
    <div>Dia: <span id="dia"></span>/100</div>
    <div>Fome: <span id="fome"></span></div>
    <div>Energia: <span id="energia"></span></div>
    <div>Sanidade: <span id="sanidade"></span></div>
    <div>Sede: <span id="sede"></span></div>
    <div>A√ß√µes: <span id="acoesDia"></span>/3</div>
  </div>
  <div id="log"></div>
  <div class="acoes" id="acoes"></div>
</div>

<!-- Vit√≥ria/Derrota -->
<div id="vitoria" class="tela">
  <h2>Voc√™ sobreviveu 100 dias!</h2>
  <button onclick="mostrarTela('menu')">Menu</button>
</div>

<div id="derrota" class="tela">
  <h2>Voc√™ n√£o resistiu.</h2>
  <button onclick="mostrarTela('menu')">Menu</button>
</div>

<script>
// ===== DOM =====
const diaEl = document.getElementById("dia");
const fomeEl = document.getElementById("fome");
const energiaEl = document.getElementById("energia");
const sanidadeEl = document.getElementById("sanidade");
const sedeEl = document.getElementById("sede");
const logEl = document.getElementById("log");
const acoesEl = document.getElementById("acoes");
const acoesDiaEl = document.getElementById("acoesDia");
const listaConq = document.getElementById("listaConq");
const listaInv = document.getElementById("listaInv");

// ===== AUDIO =====
const ctx = new (window.AudioContext||window.webkitAudioContext)();
function som(freq=200,dur=.1){
  const o=ctx.createOscillator(),g=ctx.createGain();
  o.type="square";o.frequency.value=freq;g.gain.value=.05;
  o.connect(g);g.connect(ctx.destination);
  o.start();o.stop(ctx.currentTime+dur);
}

// ===== CONQUISTAS =====
const todasConq=[
 {id:"sobreviveu",t:"Sobrevivente",d:"Chegou ao dia 100"},
 {id:"louco",t:"Colapso",d:"Sanidade zerada"},
 {id:"evento_ruim",t:"Marcado",d:"Sofreu evento grave"},
 {id:"envenenado",t:"Envenenado",d:"Sofreu uma doen√ßa grave e sobreviveu"},
 {id:"resistente",t:"Resistente",d:"Sobreviveu com status muito baixos"},
 {id:"explorador",t:"Explorador",d:"Usou Explorar 20 vezes"},
 {id:"colecionador",t:"Colecionador",d:"Pegou todos os tipos de itens"},
 {id:"extremo",t:"Sobrevivente Extremo",d:"Sobreviveu a um evento cr√≠tico de fraqueza ou doen√ßa"}
];
let conq=JSON.parse(localStorage.getItem("conq")||"[]");
function unlock(id){
  if(!conq.includes(id)){
    conq.push(id);
    localStorage.setItem("conq",JSON.stringify(conq));
    renderConq();
  }
}
function renderConq(){
  listaConq.innerHTML="";
  todasConq.forEach(c=>{
    const d=document.createElement("div");
    d.className="conq "+(conq.includes(c.id)?"unlocked":"locked");
    d.innerHTML=`<strong>${c.t}</strong> - ${c.d}`;
    listaConq.appendChild(d);
  });
}
renderConq();
function toggleConq(){
  painelConq.style.display=painelConq.style.display==="block"?"none":"block";
}

// ===== INVENT√ÅRIO =====
let inventario = [];
function addItem(item){
  inventario.push(item);
  renderInv();
}
function renderInv(){
  listaInv.innerHTML="";
  inventario.forEach((i,index)=>{
    const d=document.createElement("div");
    d.className="item";
    d.dataset.desc = i.desc;
    d.textContent = i.nome;
    d.onclick = ()=>usarItem(index);
    listaInv.appendChild(d);
  });
}
function toggleInv(){
  painelInv.style.display=painelInv.style.display==="block"?"none":"block";
}
function usarItem(index){
  const i = inventario[index];
  if(i.efeito) i.efeito();
  logMsg(`Voc√™ usou: ${i.nome}`);
  inventario.splice(index,1);
  renderInv();
  atualizarUI();
}

// ===== TELAS =====
function mostrarTela(id){
  document.body.className="";
  ["menu","dificuldade","jogo","vitoria","derrota"]
    .forEach(t=>document.getElementById(t).classList.remove("ativa"));
  document.getElementById(id).classList.add("ativa");
}

// ===== RECORDES =====
let recordeDias = parseInt(localStorage.getItem("recordeDias")||"0");
const recordeEl = document.createElement("div");
recordeEl.style.position="fixed";
recordeEl.style.left="10px";
recordeEl.style.top="10px";
recordeEl.style.fontSize="0.9em";
recordeEl.style.zIndex="15";
recordeEl.textContent = `Recorde: ${recordeDias} dias`;
document.body.appendChild(recordeEl);
function atualizarRecorde(){
  if(dia > recordeDias){
    recordeDias = dia;
    localStorage.setItem("recordeDias", recordeDias);
    recordeEl.textContent = `Recorde: ${recordeDias} dias`;
  }
}

// ===== JOGO =====
let dia,fome,energia,sanidade,sede,dificuldade,acoesNoDia,explorarCont=0;
let ultimoSave=0; // dia do √∫ltimo save

function iniciarJogo(diff){
  dificuldade=diff;
  dia=1; acoesNoDia=0; explorarCont=0; ultimoSave=0;

  if(diff==="facil"){fome=70;energia=70;sanidade=65;sede=70;}
  if(diff==="normal"){fome=60;energia=60;sanidade=55;sede=60;}
  if(diff==="dificil"){fome=50;energia=50;sanidade=45;sede=50;}

  inventario=[];
  logEl.innerHTML="";
  atualizarUI();
  gerarAcoes();
  mostrarTela("jogo");
}

// ===== SALVAR E REINICIAR =====
function salvarJogo(){
  if(dia - ultimoSave < 3){
    alert("S√≥ √© poss√≠vel salvar a cada 3 dias.");
    return;
  }
  const save = {
    dia,fome,energia,sanidade,sede,dificuldade,acoesNoDia,inventario,explorarCont,conq
  };
  localStorage.setItem("saveGame", JSON.stringify(save));
  ultimoSave = dia;
  alert("Jogo salvo!");
}

function reiniciarJogo(){
  if(confirm("Tem certeza que deseja reiniciar? O save ser√° apagado.")){
    localStorage.removeItem("saveGame");
    mostrarTela("menu");
  }
}

// ===== RESTAURAR SAVE =====
function carregarSave(){
  const save = JSON.parse(localStorage.getItem("saveGame"));
  if(save){
    dia=save.dia;
    fome=save.fome;
    energia=save.energia;
    sanidade=save.sanidade;
    sede=save.sede;
    dificuldade=save.dificuldade;
    acoesNoDia=save.acoesNoDia;
    inventario=save.inventario;
    explorarCont=save.explorarCont;
    conq=save.conq||[];
    renderConq();
    renderInv();
    atualizarUI();
    gerarAcoes();
    mostrarTela("jogo");
  }
}

// ===== ATUALIZAR UI =====
function atualizarUI(){
  diaEl.textContent=dia;
  fomeEl.textContent=Math.max(0,fome);
  energiaEl.textContent=Math.max(0,energia);
  sanidadeEl.textContent=Math.max(0,sanidade);
  sedeEl.textContent=Math.max(0,sede);
  acoesDiaEl.textContent=acoesNoDia;

  document.body.className="";
  if(fome<=25||energia<=25||sanidade<=25||sede<=25)document.body.classList.add("perigo");
  if(fome<=10||energia<=10||sanidade<=10||sede<=10)document.body.classList.add("critico");
}

// ===== LOG =====
function logMsg(m){
  logEl.innerHTML+=`<div>> ${m}</div>`;
  logEl.scrollTop=logEl.scrollHeight;
}

// ===== A√á√ïES =====
function gerarAcoes(){
  acoesEl.innerHTML="";
  [
    { t:"Comer restos", frases:["Voc√™ come algo duvidoso.","O gosto √© quase insuport√°vel."], efeito(){fome+=12;sanidade-=3;} },
    { t:"Dormir", frases:["O sono vem quebrado.","Pesadelos te acompanham."], efeito(){energia+=14;fome-=8;} },
    { t:"Explorar", frases:["Voc√™ se afasta do abrigo.","Algo parece errado l√° fora."], efeito(){energia-=12;fome-=12;explorar();} }
  ].forEach(a=>{
    const b=document.createElement("button");
    b.textContent=a.t;
    b.onclick=()=>acao(a);
    acoesEl.appendChild(b);
  });
}

// ===== EXPLORA√á√ÉO & ITENS =====
function explorar(){
  explorarCont++;
  if(explorarCont>=20) unlock("explorador");

  if(Math.random()<0.5){ 
    const itens=[
      {nome:"Comida",desc:"Restaura 15 de fome",efeito:()=>{fome+=15;}},
      {nome:"√Ågua",desc:"Restaura 15 de sede",efeito:()=>{sede+=15;}},
      {nome:"Energ√©tico",desc:"Restaura 15 de energia",efeito:()=>{energia+=15;}},
      {nome:"Rem√©dio",desc:"Restaura 15 de sanidade",efeito:()=>{sanidade+=15;}}
    ];
    const item=itens[Math.floor(Math.random()*itens.length)];
    addItem(item);
    logMsg(`Voc√™ encontrou um item: ${item.nome}`);
  }
}

// ===== EVENTOS ALEAT√ìRIOS =====
function eventoAleatorio(){
  let impacto = dificuldade==="facil"?1:dificuldade==="normal"?1.4:1.8;
  if(Math.random()<0.7){
    const eventos=[
      ()=>{sanidade-=8*impacto; logMsg("A sensa√ß√£o de ser observado retorna."); unlock("evento_ruim"); som(90,.3);},
      ()=>{fome-=10*impacto; logMsg("Parte do pouco que restava se perde."); som(70,.3);},
      ()=>{energia-=12*impacto; logMsg("Voc√™ trope√ßa e se machuca, energia reduz."); som(120,.3);},
      ()=>{sede-=12*impacto; logMsg("O calor castiga, sua sede aumenta."); som(150,.3);},
      ()=>{
        if(Math.random()<0.3){sanidade-=15*impacto; energia-=10*impacto;
          logMsg("Voc√™ contraiu uma doen√ßa! Rem√©dios podem curar."); unlock("envenenado"); som(60,.6);}
      }
    ];
    eventos[Math.floor(Math.random()*eventos.length)]();
  }
}

// ===== A√á√ÉO PRINCIPAL =====
function acao(a){
  som(220,.1);
  logMsg(a.frases[Math.floor(Math.random()*a.frases.length)]);
  a.efeito();
  eventoAleatorio();

  acoesNoDia++;
  if(acoesNoDia>=3){
    dia++;
    acoesNoDia=0;
    logMsg("A noite chega. Voc√™ sobreviveu a mais um dia.");
    atualizarRecorde();
    if(fome<15 && energia<15 && sanidade<15 && sede<15) unlock("resistente");
  }

  atualizarUI();
  checarFim();
}

// ===== CHECAR FIM =====
function checarFim(){
  if(fome<=0||energia<=0||sanidade<=0||sede<=0){
    if(sanidade<=0) unlock("louco");
    som(60,.6);
    mostrarTela("derrota");
    return;
  }
  if(dia>100){
    unlock("sobreviveu");
    som(700,.5);
    mostrarTela("vitoria");
  }
}

// ===== CARREGAR SAVE AO INICIAR =====
window.onload = function(){
  const saveExist = localStorage.getItem("saveGame");
  if(saveExist && confirm("Save encontrado! Deseja continuar de onde parou?")){
    carregarSave();
  }
}

// ===== REGISTRAR SERVICE WORKER =====
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js")
    .then(() => console.log("Service Worker registrado com sucesso!"))
    .catch(err => console.log("Erro ao registrar SW:", err));
}
</script>
</body>
</html>
